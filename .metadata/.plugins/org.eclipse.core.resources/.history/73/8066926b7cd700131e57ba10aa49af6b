package com.edu.sql;

import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;

import com.edu.birthday.R;

import android.content.Context;
import android.database.sqlite.SQLiteDatabase;

public class SqlDatebase {
	
	private Context context;
	private static SqlDatebase Instance;
	private SQLiteDatabase sqLiteDatabase;
	
	public SqlDatebase(Context context){
		sqLiteDatabase = fromOutCopyDate();
	}
	
	public static synchronized SqlDatebase getInstance(Context context){
		if(Instance == null){
			Instance = new SqlDatebase(context);
		}
		return Instance;
	}
	
	public SQLiteDatabase fromOutCopyDate(){
		String DATEBASE_PATH = "/data/data/com.edu.birthday/databases";
		String DATEBASE_FILENAME = "Birthday_sms.db";
		
//		数据的绝对路径
		String datebasePath = DATEBASE_PATH + "/" + DATEBASE_FILENAME;
		File path = new File(DATEBASE_PATH);
		//建立文件夹
		if(!path.exists()){
			path.mkdir();
		}
		//建立一个文件
		if(!(new File(datebasePath)).exists()){
			InputStream inputStream = context.getResources().openRawResource(R.raw.wishdata);
			
			try{
				FileOutputStream fileOutputStream = new FileOutputStream(datebasePath);
				byte data[] = new byte[2048];
				
				int index = 0;
				while((index = inputStream.read(data)) != -1){
					fileOutputStream.write(data, 0, index);
				}
				inputStream.close();
				fileOutputStream.close();
			}catch(Exception e){
				e.printStackTrace();
			}
		}

		SQLiteDatabase sqLiteDatabase = SQLiteDatabase.openOrCreateDatabase(datebasePath, null);
		return sqLiteDatabase;
	}
}
